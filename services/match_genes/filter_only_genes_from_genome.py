import pandas as pd

path = 'C:/Users/keren/PycharmProjects/project/Homo_sapiens.GRCh37.87.gff3'

cols = ["seqid", "type", "start", "end"]
df = pd.read_csv(path, usecols=[0, 2, 3, 4],  names=cols, dtype={'seqid': 'str'}, comment='#', sep='\t', header=None)
df = df[df['type'] == 'gene'].reset_index(drop=True)
df = df.rename(columns={'seqid': 'chromosome'})
df.drop(['type'], axis=1, inplace=True)


chromosome_to_int = {'10': 10, '11': 11, '12': 12, '13': 13, '14': 14, '15': 15, '16': 16, '17': 17, '18': 18,
                     '19': 19, '1': 1, '20': 20, '21': 21, '22': 22, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6,
                     '7': 7, '8': 8, '9': 9, 'MT': 23, 'X': 24, 'Y': 25, "GL000192.1": 26, "GL000225.1": 27,
                     "GL000194.1": 28, "GL000193.1": 29, "GL000200.1": 30, "GL000222.1": 31, "GL000212.1": 32,
                     "GL000195.1": 33, "GL000223.1": 34, "GL000224.1": 35, "GL000219.1": 36, "GL000205.1": 37,
                     "GL000215.1": 38, "GL000216.1": 39, "GL000217.1": 40, "GL000199.1": 41, "GL000211.1": 42,
                     "GL000213.1": 43, "GL000220.1": 44, "GL000218.1": 45, "GL000209.1": 46, "GL000221.1": 47,
                     "GL000214.1": 48, "GL000228.1": 49, "GL000227.1": 50, "GL000191.1": 51, "GL000208.1": 52,
                     "GL000198.1": 53, "GL000204.1": 54, "GL000233.1": 55, "GL000237.1": 56, "GL000230.1": 57,
                     "GL000242.1": 58, "GL000243.1": 59, "GL000241.1": 60, "GL000236.1": 61, "GL000240.1": 62,
                     "GL000206.1": 63, "GL000232.1": 64, "GL000234.1": 65, "GL000202.1": 66, "GL000238.1": 67,
                     "GL000244.1": 68, "GL000248.1": 69, "GL000196.1": 70, "GL000249.1": 71, "GL000246.1": 72,
                     "GL000203.1": 73, "GL000197.1": 74, "GL000245.1": 75, "GL000247.1": 76, "GL000201.1": 77,
                     "GL000235.1": 78, "GL000239.1": 79, "GL000210.1": 80, "GL000231.1": 81, "GL000229.1": 82,
                     "GL000226.1": 83, "GL000207.1": 84}

df["chromosome"].replace(chromosome_to_int, inplace=True)

df.to_csv("genes.csv", sep='\t', encoding='utf-8')